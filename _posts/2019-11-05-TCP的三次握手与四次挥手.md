---
title: TCP的三次握手与四次挥手
tags: 计算机网络
---

### TCP报文

![TCP报文](https://i.loli.net/2019/11/05/OdqCv4MhyUjc9J7.png)

- 端口号
	端口号是用来区分操作系统中不同进程的.
	- 源端口 : 发送TCP报文的应用程序的端口
	- 目的端口 : TCP报文的接收端口
- 序号(Sequence number) : 发送出去字节的最末尾序列号
- 确认序号(Acknowledgement number) : 已经确认接收到的字节的序号
- 数据偏移 : 以4个字节为单位, 数据的偏移位, 占4位, 所以TCP头部最大长度为15 * 32 / 8 = 60字节
- 保留 : 3位 以后使用
- NS—ECN-nonce。[关于NS的具体解释](https://www.inacon.de/ph/data/TCP/Header_fields/Flags/TCP-Header-Field-ECN_Flag-NS_OS_RFC-793_3540.htm)
- CWR : 用于拥塞处理。[关于CWR的具体解释](https://www.inacon.de/ph/data/TCP/Header_fields/Flags/TCP-Header-Field-ECN_Flag-CWR_OS_RFC-793_3540.htm)
- ECE : ECN-Echo有两种意思，取决于SYN标志的值。
- URG : 默认为0, 1表示紧急数据包. 此时紧急指针有效.
- ACK : 为1表示确认序号有效, 除了TCP发起建立的第一条报文, 建立成功之后发送的报文ACK均为1
- PSH : 为1表示是带有PUSH标志的数据，指示接收方应该尽快将这个报文段交给应用层而不用等待缓冲区装满
- RST : 为1表示出现严重差错。可能需要重新创建TCP连接。还可以用于拒绝非法的报文段和拒绝连接请求
- SYN : 为1表示这是连接请求或是连接接受请求，用于创建连接和使顺序号同步
- FIN : 为1表示发送方没有数据要传输了，要求释放连接
- 窗口(win) : 表示接下来能接收到的最大字节数, 即接收窗口的大小, 用于流量控制
- 效验和 (Check sum) : 用来检查整个TCP报文段是否在传输过程中错误.
- 紧急指针(Urgent pointer) : 本报文段中紧急数据的最后一个字节的位置.
- 选项字段(Options)
- 数据部分(Data) : 数据部分是可选的. 在第三次握手的报文中是可以携带数据的.[车大的知乎回答](https://www.zhihu.com/question/66407996/answer/242152945)

未完待续


>参考:
>[TCP wiki](https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE)
>[Protocol Help](https://www.inacon.de/ph/data/TCP/Header_fields/Flags/TCP-Header-Field-Flag-SYN_OS_RFC-793_3540.htm)
